(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[107],{5230:function(e,t,r){Promise.resolve().then(r.bind(r,9682))},9682:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return h}});var n=r(7437),a=r(2265),s=r(9376),i=r(2660),o=r(5974),l=r(2869),c=r(6070),u=r(4508);let d=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("textarea",{className:(0,u.cn)("min-h-[120px] w-full rounded-xl border border-border bg-card px-3 py-2 text-sm text-fg placeholder:text-slate-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-accent",r),ref:t,...a})});d.displayName="Textarea";var f=r(9116),m=r(6023);function h(){var e;let t=(0,s.useParams)(),r=null!==(e=(0,s.useSearchParams)().get("platform"))&&void 0!==e?e:"email",[u,h]=(0,a.useState)(null),[p,x]=(0,a.useState)(""),[v,g]=(0,a.useState)(null),[y,b]=(0,a.useState)(!0);(0,a.useEffect)(()=>{let e=(0,m.LP)();e&&t.id&&(b(!0),(0,f.G7)(e,t.id,r).then(h).catch(e=>g(e instanceof Error?e.message:"Failed to load thread")).finally(()=>b(!1)))},[t.id,r]);let j=(0,a.useMemo)(()=>null==u?void 0:u.messages.find(e=>"incoming"===e.direction),[u]),w=async()=>{if(!u||!j)return;let e=(0,m.LP)();if(e)try{await (0,f.ts)(e,j.id,p,r),x("");let n=await (0,f.G7)(e,t.id,r);h(n),g("Reply sent successfully.")}catch(e){g(e instanceof Error?e.message:"Failed to send reply")}};return(0,n.jsxs)("div",{children:[(0,n.jsx)(i.Z,{title:"Thread View",subtitle:"Read full context and send a reply."}),y?(0,n.jsx)("p",{className:"text-sm text-slate-500",children:"Loading thread..."}):null,v?(0,n.jsx)("p",{className:"mb-4 text-sm text-slate-600",children:v}):null,u?(0,n.jsxs)("div",{className:"grid gap-4 lg:grid-cols-[2fr,1fr]",children:[(0,n.jsxs)(c.Zb,{children:[(0,n.jsxs)(c.Ol,{children:[(0,n.jsx)(c.ll,{children:u.subject||"Conversation"}),(0,n.jsxs)(c.SZ,{children:["Participants: ",u.participants.join(", ")||"N/A"]})]}),(0,n.jsx)(c.aY,{className:"space-y-3",children:u.messages.map(e=>(0,n.jsxs)("div",{className:"rounded-xl border border-border bg-white p-3",children:[(0,n.jsxs)("div",{className:"mb-2 flex flex-wrap items-center gap-2",children:[(0,n.jsx)(o.C,{variant:"secondary",children:e.platform}),(0,n.jsx)(o.C,{variant:"incoming"===e.direction?"outline":"default",children:e.direction}),(0,n.jsx)(o.C,{variant:"urgent"===e.priority?"urgent":"low"===e.priority?"low":"outline",children:e.priority})]}),(0,n.jsxs)("p",{className:"text-xs text-slate-500",children:[e.sender," â€¢ ",new Date(e.sent_at).toLocaleString()]}),(0,n.jsx)("p",{className:"mt-2 text-sm",children:e.body})]},e.id))})]}),(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)(c.Zb,{children:[(0,n.jsxs)(c.Ol,{children:[(0,n.jsx)(c.ll,{children:"Thread Summary"}),(0,n.jsx)(c.SZ,{children:"Phase 2 summary placeholder."})]}),(0,n.jsx)(c.aY,{children:(0,n.jsx)("p",{className:"text-sm text-slate-600",children:"AI summary will appear here once summarization is enabled for this platform."})})]}),(0,n.jsxs)(c.Zb,{children:[(0,n.jsxs)(c.Ol,{children:[(0,n.jsx)(c.ll,{children:"Reply"}),(0,n.jsx)(c.SZ,{children:"Send a direct response to the latest inbound message."})]}),(0,n.jsxs)(c.aY,{className:"space-y-3",children:[(0,n.jsx)(d,{value:p,onChange:e=>x(e.target.value),placeholder:"Type your response..."}),(0,n.jsx)(l.z,{onClick:w,disabled:!p.trim()||!j,children:"Send Reply"})]})]})]})]}):null]})}},2660:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(7437);let a=(0,r(9205).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);var s=r(5186);function i(e){let{title:t,subtitle:r}=e;return(0,n.jsxs)("header",{className:"mb-6 flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-2xl font-semibold tracking-tight",children:t}),r?(0,n.jsx)("p",{className:"text-sm text-slate-500",children:r}):null]}),(0,n.jsxs)("div",{className:"relative w-full md:w-72",children:[(0,n.jsx)(a,{className:"pointer-events-none absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-slate-400"}),(0,n.jsx)(s.I,{placeholder:"Search messages...",className:"pl-9"})]})]})}},5974:function(e,t,r){"use strict";r.d(t,{C:function(){return o}});var n=r(7437);r(2265);var a=r(535),s=r(4508);let i=(0,a.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-medium transition-colors",{variants:{variant:{default:"border-transparent bg-accent text-accentfg",secondary:"border-border bg-muted text-fg",outline:"border-border text-fg",urgent:"border-red-300 bg-red-50 text-red-700",low:"border-slate-300 bg-slate-50 text-slate-700"}},defaultVariants:{variant:"default"}});function o(e){let{className:t,variant:r,...a}=e;return(0,n.jsx)("div",{className:(0,s.cn)(i({variant:r}),t),...a})}},2869:function(e,t,r){"use strict";r.d(t,{z:function(){return l}});var n=r(7437),a=r(2265),s=r(535),i=r(4508);let o=(0,s.j)("inline-flex items-center justify-center rounded-xl text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-accent text-accentfg hover:opacity-90",outline:"border border-border bg-transparent text-fg hover:bg-muted",ghost:"text-fg hover:bg-muted",destructive:"bg-red-600 text-white hover:bg-red-500"},size:{default:"h-10 px-4 py-2",sm:"h-9 px-3",lg:"h-11 px-8"}},defaultVariants:{variant:"default",size:"default"}}),l=a.forwardRef((e,t)=>{let{className:r,variant:a,size:s,...l}=e;return(0,n.jsx)("button",{className:(0,i.cn)(o({variant:a,size:s,className:r})),ref:t,...l})});l.displayName="Button"},6070:function(e,t,r){"use strict";r.d(t,{Ol:function(){return o},SZ:function(){return c},Zb:function(){return i},aY:function(){return u},ll:function(){return l}});var n=r(7437),a=r(2265),s=r(4508);let i=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,s.cn)("rounded-2xl border border-border bg-card shadow-soft",r),...a})});i.displayName="Card";let o=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,s.cn)("flex flex-col space-y-1.5 p-6",r),...a})});o.displayName="CardHeader";let l=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("h3",{ref:t,className:(0,s.cn)("text-lg font-semibold leading-none tracking-tight",r),...a})});l.displayName="CardTitle";let c=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("p",{ref:t,className:(0,s.cn)("text-sm text-slate-500",r),...a})});c.displayName="CardDescription";let u=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,s.cn)("p-6 pt-0",r),...a})});u.displayName="CardContent",a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,s.cn)("flex items-center p-6 pt-0",r),...a})}).displayName="CardFooter"},5186:function(e,t,r){"use strict";r.d(t,{I:function(){return i}});var n=r(7437),a=r(2265),s=r(4508);let i=a.forwardRef((e,t)=>{let{className:r,type:a,...i}=e;return(0,n.jsx)("input",{type:a,className:(0,s.cn)("flex h-10 w-full rounded-xl border border-border bg-card px-3 py-2 text-sm text-fg placeholder:text-slate-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-accent",r),ref:t,...i})});i.displayName="Input"},9116:function(e,t,r){"use strict";r.d(t,{A7:function(){return m},G7:function(){return h},Zk:function(){return x},me:function(){return u},rC:function(){return f},ts:function(){return p},uJ:function(){return d},x4:function(){return c}});var n,a,s=r(257);let i=null!==(n=s.env.NEXT_PUBLIC_AUTH_API_URL)&&void 0!==n?n:"http://localhost:8001",o=null!==(a=s.env.NEXT_PUBLIC_GATEWAY_API_URL)&&void 0!==a?a:"http://localhost:8000";async function l(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3?arguments[3]:void 0,a=new Headers(r.headers);a.set("Content-Type","application/json"),n&&a.set("Authorization","Bearer ".concat(n));let s=await fetch("".concat(e).concat(t),{...r,headers:a,cache:"no-store"});if(!s.ok)throw Error(await s.text()||"".concat(s.status," ").concat(s.statusText));return await s.json()}async function c(e,t){return l(i,"/auth/login",{method:"POST",body:JSON.stringify({email:e,password:t})})}async function u(e){return l(i,"/auth/me",{},e)}async function d(){return l(i,"/auth/roles")}async function f(e){return l(i,"/auth/users",{},e)}async function m(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50;return(await l(o,"/messages/unread?platform=".concat(encodeURIComponent(t),"&limit=").concat(r),{},e)).messages}async function h(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"email";return(await l(o,"/threads/".concat(t,"?platform=").concat(encodeURIComponent(r)),{},e)).thread}async function p(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"email";return(await l(o,"/messages/".concat(t,"/reply"),{method:"POST",body:JSON.stringify({platform:n,content:r})},e)).message}async function x(e){return(await l(o,"/platforms",{},e)).platforms}},6023:function(e,t,r){"use strict";r.d(t,{LP:function(){return a},o4:function(){return s},qz:function(){return i}});let n="mpi_access_token";function a(){return localStorage.getItem(n)}function s(e){localStorage.setItem(n,e),document.cookie="access_token=".concat(e,"; path=/; max-age=").concat(604800,"; samesite=lax")}function i(){localStorage.removeItem(n),document.cookie="access_token=; path=/; max-age=0; samesite=lax"}},4508:function(e,t,r){"use strict";r.d(t,{cn:function(){return s}});var n=r(1994),a=r(3335);function s(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,a.m6)((0,n.W)(t))}},9205:function(e,t,r){"use strict";r.d(t,{Z:function(){return l}});var n=r(2265);let a=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),s=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var i={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let o=(0,n.forwardRef)((e,t)=>{let{color:r="currentColor",size:a=24,strokeWidth:o=2,absoluteStrokeWidth:l,className:c="",children:u,iconNode:d,...f}=e;return(0,n.createElement)("svg",{ref:t,...i,width:a,height:a,stroke:r,strokeWidth:l?24*Number(o)/Number(a):o,className:s("lucide",c),...f},[...d.map(e=>{let[t,r]=e;return(0,n.createElement)(t,r)}),...Array.isArray(u)?u:[u]])}),l=(e,t)=>{let r=(0,n.forwardRef)((r,i)=>{let{className:l,...c}=r;return(0,n.createElement)(o,{ref:i,iconNode:t,className:s("lucide-".concat(a(e)),l),...c})});return r.displayName="".concat(e),r}},9376:function(e,t,r){"use strict";var n=r(5475);r.o(n,"useParams")&&r.d(t,{useParams:function(){return n.useParams}}),r.o(n,"usePathname")&&r.d(t,{usePathname:function(){return n.usePathname}}),r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}}),r.o(n,"useSearchParams")&&r.d(t,{useSearchParams:function(){return n.useSearchParams}})},257:function(e,t,r){"use strict";var n,a;e.exports=(null==(n=r.g.process)?void 0:n.env)&&"object"==typeof(null==(a=r.g.process)?void 0:a.env)?r.g.process:r(4227)},4227:function(e){!function(){var t={229:function(e){var t,r,n,a=e.exports={};function s(){throw Error("setTimeout has not been defined")}function i(){throw Error("clearTimeout has not been defined")}function o(e){if(t===setTimeout)return setTimeout(e,0);if((t===s||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(r){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:s}catch(e){t=s}try{r="function"==typeof clearTimeout?clearTimeout:i}catch(e){r=i}}();var l=[],c=!1,u=-1;function d(){c&&n&&(c=!1,n.length?l=n.concat(l):u=-1,l.length&&f())}function f(){if(!c){var e=o(d);c=!0;for(var t=l.length;t;){for(n=l,l=[];++u<t;)n&&n[u].run();u=-1,t=l.length}n=null,c=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===i||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function h(){}a.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];l.push(new m(e,t)),1!==l.length||c||o(f)},m.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=h,a.addListener=h,a.once=h,a.off=h,a.removeListener=h,a.removeAllListeners=h,a.emit=h,a.prependListener=h,a.prependOnceListener=h,a.listeners=function(e){return[]},a.binding=function(e){throw Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(e){throw Error("process.chdir is not supported")},a.umask=function(){return 0}}},r={};function n(e){var a=r[e];if(void 0!==a)return a.exports;var s=r[e]={exports:{}},i=!0;try{t[e](s,s.exports,n),i=!1}finally{i&&delete r[e]}return s.exports}n.ab="//";var a=n(229);e.exports=a}()},535:function(e,t,r){"use strict";r.d(t,{j:function(){return i}});var n=r(1994);let a=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,s=n.W,i=(e,t)=>r=>{var n;if((null==t?void 0:t.variants)==null)return s(e,null==r?void 0:r.class,null==r?void 0:r.className);let{variants:i,defaultVariants:o}=t,l=Object.keys(i).map(e=>{let t=null==r?void 0:r[e],n=null==o?void 0:o[e];if(null===t)return null;let s=a(t)||a(n);return i[e][s]}),c=r&&Object.entries(r).reduce((e,t)=>{let[r,n]=t;return void 0===n||(e[r]=n),e},{});return s(e,l,null==t?void 0:null===(n=t.compoundVariants)||void 0===n?void 0:n.reduce((e,t)=>{let{class:r,className:n,...a}=t;return Object.entries(a).every(e=>{let[t,r]=e;return Array.isArray(r)?r.includes({...o,...c}[t]):({...o,...c})[t]===r})?[...e,r,n]:e},[]),null==r?void 0:r.class,null==r?void 0:r.className)}}},function(e){e.O(0,[137,971,117,744],function(){return e(e.s=5230)}),_N_E=e.O()}]);